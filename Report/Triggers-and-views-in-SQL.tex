\documentclass{report}

% Paquetes y configuraciones adicionales
\usepackage{graphicx}
\usepackage[export]{adjustbox}
\usepackage{caption}
\usepackage{float}
\usepackage{titlesec}
\usepackage{geometry}
\usepackage{hyperref}


% Configura los márgenes
\geometry{
    left=2cm,   % Ajusta este valor al margen izquierdo deseado
    right=2cm,  % Ajusta este valor al margen derecho deseado
    top=3cm,
    bottom=3cm,
}

% Configuración de los títulos de las secciones
\titlespacing{\section}{0pt}{\parskip}{\parskip}
\titlespacing{\subsection}{0pt}{\parskip}{\parskip}
\titlespacing{\subsubsection}{0pt}{\parskip}{\parskip}


\begin{document}
	
	% Portada del informe
	
	\title{Disparadores y Vistas en SQL}
	\author{Samuel Martín Morales}
	\date{\today}
	
	\maketitle
	
	% Índice
	\tableofcontents
	
	% Secciones del informe
	\chapter{Introducción}
  Para esta cuarta práctica de la asignatura \emph{Administración y Diseño de Bases de Datos} se solicita el empleo de una base de datos que debe de ser restaurada de manera previa a la implementación de una serie de ejercicios que son demandados haciendo uso de dicha base de datos.\\

	En este caso, la base de datos a emplear se denomina como \emph{\textbf{alquilerdvd.tar}} y se encuentra disponible en el campus virtual de la asignatura. Pero, puede ser descargada desde el siguiente enlace de \href{https://github.com/Samuelmm15/PostgreSQL-Rent/blob/main/AlquilerPractica.tar}{GitHub}.\\

	Dicha base de datos se encuentra en formato \emph{.tar} por lo que, para poder restaurarla, se debe de emplear el siguiente comando:

	\begin{verbatim}
		$ pg_restore -U postgres -d alquilerdvd alquilerdvd.tar
	\end{verbatim}

	Es decir, el comando anterior restaura la base de datos \emph{alquilerdvd} haciendo uso del fichero \emph{alquilerdvd.tar} y empleando el usuario \emph{postgres}.\\

	Una vez restaurada la base de datos, se puede proceder a la realización de los distintos ejercicios.\\

	\chapter{Resultados}
	\section{Ejercicio 1}
	Para el primer ejercicio de la práctica, se deben de identificar las distintas tablas, vistas y secuencias que tiene la base de datos que ha sido restaurada.\\

	Tras la carga de la base de datos a partir del fichero con extensión \emph{.tar}, se puede observar que la base de datos \emph{alquilerdvd} cuenta con un total de 15 tablas, 4 vistas y 15 secuencias. Para poder visualizar todos estos datos comentados sobre la base de datos, se hace uso de la terminal interactiva de \emph{PostgreSQL}, es decir, de \emph{psql}, y, una vez dentro de la base de datos se ejecutan los siguientes comandos para obtener los distintos valores obsevados anteriormente:

	\begin{verbatim}
		# \dt 		-- Muestra las tablas de la base de datos 
		# \dv		 -- Muestra las vistas de la base de datos
		# \ds		 -- Muestra las secuencias de la base de datos
	\end{verbatim}

	\section{Ejercicio 2}
	Tras la identificación de las distintas tablas más importantes de la base de datos junto con sus atributos  y relaciones entre las distintas tablas, se procede a la implementación de distintas consultas que permitan obtener aquella información que es solicitada en el enunciado del ejercicio.\\

	\subsection{Ventas totales}
	Para obtener las ventas totales por categoría de películas ordendas de manera descendente, se emplea la siguiente consulta:

	\begin{verbatim}
		SELECT COUNT(*) AS total_rent, category.name AS category_name
		FROM rental
		INNER JOIN inventory ON rental.inventory_id = inventory.inventory_id
		INNER JOIN film ON inventory.film_id = film.film_id
		INNER JOIN film_category ON film.film_id = film_category.film_id
		INNER JOIN category ON film_category.category_id = category.category_id
		GROUP BY category_name
		ORDER BY total_rent DESC;
	\end{verbatim}
	
	\chapter{Conclusiones}
  Example....	

	\chapter{Bibliografía}
	Example....
	
\end{document}